# Config file for automatic testing at travis-ci.org
sudo: required

language: python

cache:
  directories:
    - $HOME/.cache/db
    - node_modules

env:
  - TOXENV=quality
  - TOXENV=docs
  - TOXENV=django18
  - API_SPEC=1 OPENEDX_RELEASE=ginkgo.1

before_install:
  # Upgrade docker-compose
  - bin/ci before-install

install:
  - bin/ci install

script:
  - bin/ci script

after_success:
  - bin/ci after-success

# Set password via "travis encrypt --add deploy.password"; for details, see
# https://docs.travis-ci.com/user/deployment/pypi
deploy:
  provider: pypi
  user: edx
  distributions: sdist bdist_wheel
  on:
    tags: true
    condition: '$TOXENV = quality'
